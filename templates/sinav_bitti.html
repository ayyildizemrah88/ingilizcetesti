{% extends "base.html" %}
{% block title %}Sınav Tamamlandı - Skills Test Center{% endblock %}

{% block content %}
<div class="row justify-content-center mt-5">
    <div class="col-lg-8">
        <div class="card border-0 text-center">
            <div class="card-body p-5">
                <div class="mb-4">
                    {% if puan >= 75 %}
                    <i class="bi bi-trophy-fill text-warning" style="font-size: 5rem;"></i>
                    <h2 class="mt-3 text-success">Mükemmel!</h2>
                    {% elif puan >= 60 %}
                    <i class="bi bi-award-fill text-primary" style="font-size: 5rem;"></i>
                    <h2 class="mt-3 text-primary">Tebrikler!</h2>
                    {% elif puan >= 45 %}
                    <i class="bi bi-emoji-smile text-info" style="font-size: 5rem;"></i>
                    <h2 class="mt-3 text-info">İyi Bir Başlangıç!</h2>
                    {% else %}
                    <i class="bi bi-book text-secondary" style="font-size: 5rem;"></i>
                    <h2 class="mt-3 text-secondary">Geliştirebilirsiniz!</h2>
                    {% endif %}
                </div>

                <p class="lead text-muted mb-4">Sınavınız başarıyla tamamlandı.</p>

                <!-- Score Display Cards -->
                <div class="row g-3 mb-4">
                    <!-- 100'lük Puan -->
                    <div class="col-md-3 col-6">
                        <div class="bg-primary bg-opacity-10 rounded-3 p-3">
                            <h2 class="display-5 fw-bold text-primary mb-0">{{ puan }}</h2>
                            <small class="text-muted">100 Üzerinden</small>
                        </div>
                    </div>

                    <!-- IELTS Band -->
                    <div class="col-md-3 col-6">
                        <div class="bg-success bg-opacity-10 rounded-3 p-3">
                            {% set band = ((puan / 100) * 9)|round(1) %}
                            {% if puan >= 90 %}{% set band = 9 %}
                            {% elif puan >= 85 %}{% set band = 8.5 %}
                            {% elif puan >= 80 %}{% set band = 8 %}
                            {% elif puan >= 75 %}{% set band = 7.5 %}
                            {% elif puan >= 70 %}{% set band = 7 %}
                            {% elif puan >= 65 %}{% set band = 6.5 %}
                            {% elif puan >= 60 %}{% set band = 6 %}
                            {% elif puan >= 55 %}{% set band = 5.5 %}
                            {% elif puan >= 50 %}{% set band = 5 %}
                            {% elif puan >= 45 %}{% set band = 4.5 %}
                            {% elif puan >= 40 %}{% set band = 4 %}
                            {% else %}{% set band = 3.5 %}{% endif %}
                            <h2 class="display-5 fw-bold text-success mb-0">{{ band }}</h2>
                            <small class="text-muted">IELTS Band</small>
                        </div>
                    </div>

                    <!-- CEFR Level -->
                    <div class="col-md-3 col-6">
                        <div class="bg-info bg-opacity-10 rounded-3 p-3">
                            <h2 class="display-5 fw-bold text-info mb-0">{{ seviye }}</h2>
                            <small class="text-muted">CEFR Seviye</small>
                        </div>
                    </div>

                    <!-- Doğru/Toplam -->
                    <div class="col-md-3 col-6">
                        <div class="bg-secondary bg-opacity-10 rounded-3 p-3">
                            <h2 class="display-5 fw-bold text-secondary mb-0">{{ dogru }}/{{ total }}</h2>
                            <small class="text-muted">Doğru Cevap</small>
                        </div>
                    </div>
                </div>

                <!-- Level Description -->
                <div class="alert alert-light mb-4">
                    {% if seviye == 'C2' %}
                    <strong>Uzman Kullanıcı:</strong> Dili anadil düzeyinde kullanabilirsiniz.
                    {% elif seviye == 'C1' %}
                    <strong>İleri Düzey:</strong> Karmaşık konularda akıcı konuşabilirsiniz.
                    {% elif seviye == 'B2' %}
                    <strong>Üst Orta:</strong> Soyut konuları rahatlıkla ifade edebilirsiniz.
                    {% elif seviye == 'B1' %}
                    <strong>Orta Düzey:</strong> Günlük hayatta rahatlıkla iletişim kurabilirsiniz.
                    {% elif seviye == 'A2' %}
                    <strong>Temel:</strong> Basit cümle ve ifadeler kurabilirsiniz.
                    {% else %}
                    <strong>Başlangıç:</strong> Temel kelime ve kalıpları anlayabilirsiniz.
                    {% endif %}
                </div>

                <div class="alert alert-info">
                    <i class="bi bi-shield-check me-2"></i>
                    Sertifika Doğrulama Kodu: <strong>{{ cert_hash }}</strong>
                </div>

                <div class="d-grid gap-2 col-md-6 mx-auto">
                    <a href="/cert/verify/{{ cert_hash }}" class="btn btn-primary btn-lg">
                        <i class="bi bi-patch-check me-2"></i>Sertifikayı Görüntüle
                    </a>
                    <a href="/cert/pdf/{{ cert_hash }}" class="btn btn-outline-success">
                        <i class="bi bi-file-earmark-pdf me-2"></i>PDF İndir
                    </a>
                    <a href="/" class="btn btn-outline-secondary">
                        <i class="bi bi-house me-1"></i>Ana Sayfa
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
